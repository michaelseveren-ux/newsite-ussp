---
import type { ContentType, PostCategory } from '../types/post';

interface Props {
  slug: string;
  title: string;
  excerpt: string;
  featuredImage: { url: string; alt: string };
  category: PostCategory;
  contentType: ContentType;
  publishDate: string;
}

const { slug, title, excerpt, featuredImage, category, contentType, publishDate } = Astro.props;

const categoryLabels: Record<PostCategory, string> = {
  news: 'News',
  stories: 'Stories',
  videos: 'Videos',
};

const categoryColors: Record<PostCategory, string> = {
  news: 'bg-blue-500',
  stories: 'bg-emerald-500',
  videos: 'bg-purple-500',
};

const formattedDate = new Date(publishDate).toLocaleDateString('en-US', {
  month: 'long',
  day: 'numeric',
  year: 'numeric',
});

const href = `/blog/${slug}`;
---

<a
  href={href}
  class="group block bg-white rounded-xl overflow-hidden shadow-lg hover:shadow-xl transition-all duration-300"
  data-category={category}
>
  <!-- Image -->
  <div class="relative aspect-[16/9] overflow-hidden">
    <img
      src={featuredImage.url}
      alt={featuredImage.alt}
      class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
      loading="lazy"
    />
    <!-- Category Badge -->
    <div class="absolute top-4 left-4">
      <span class:list={['px-3 py-1 text-xs font-medium text-white rounded-full', categoryColors[category]]}>
        {categoryLabels[category]}
      </span>
    </div>
    <!-- Video Play Icon Overlay -->
    {contentType === 'video' && (
      <div class="absolute inset-0 flex items-center justify-center">
        <div class="w-16 h-16 bg-white/90 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform">
          <svg class="w-8 h-8 text-primary-900 ml-1" fill="currentColor" viewBox="0 0 24 24">
            <path d="M8 5v14l11-7z" />
          </svg>
        </div>
      </div>
    )}
  </div>

  <!-- Content -->
  <div class="p-6">
    <!-- Date and Type -->
    <div class="flex items-center gap-3 text-sm text-gray-500 mb-3">
      <span>{formattedDate}</span>
      {contentType === 'article' && (
        <span class="flex items-center gap-1">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg>
          Article
        </span>
      )}
      {contentType === 'video' && (
        <span class="flex items-center gap-1">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
          </svg>
          Video
        </span>
      )}
    </div>

    <!-- Title -->
    <h3 class="text-xl font-bold text-primary-900 mb-3 group-hover:text-accent-600 transition-colors line-clamp-2">
      {title}
    </h3>

    <!-- Excerpt -->
    <p class="text-gray-600 mb-4 line-clamp-2">
      {excerpt}
    </p>

    <!-- Read More -->
    <span class="text-accent-600 font-medium group-hover:translate-x-1 transition-transform inline-flex items-center gap-1">
      {contentType === 'video' ? 'Watch Video' : 'Read More'}
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
    </span>
  </div>
</a>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
